/**  * @fileOverview This file runs at the beginning of every javascript thread * as documented here: http://doc.wakanda.org/Wakanda0.v5/help/Title/en/page3845.html * @author Welsh Harris * @created 10/21/2013 * * @name Wakalorie * @copyright (c) 2013 CoreBits DataWorks LLC * @license Released under the MIT license (included in distribution in MIT LICENSE.txt) *///custom login listenerloginListener = function loginListener(email, password) {	"use strict";		var dsUser = {},		authenticated = false,		retObj = {},		result;		if (email === "admin") { //pass auth over to wakanda directory			//note that the ds isn't always loaded when this runs, so have to		//check for hardcoded admin names here		result = false; 			} else {				dsUser = ds.User.find('email = :1', email.toLowerCase());		if (dsUser !== null) { 					//we found a user with the given email, now auth the password			authenticated = dsUser.validatePassword(password);					//build success or error object			if (authenticated === true) { 				retObj =  {					ID: dsUser.uuid,					name: dsUser.email,					fullName: dsUser.email,					belongsTo: ["User"]				};		} else {			retObj = {				error: 1,				errorMessage: 'invalid email and/or password'			};		}				//return sucess or error object		result = retObj;				} else { //pass auth over to wakanda directory			result = false; 		}			}		return result;}